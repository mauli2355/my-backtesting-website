<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Backtester</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #1a1a2e; color: #e0e0e0; }
        .container-fluid { display: flex; align-items: center; justify-content: center; min-height: 100vh; }
        .card { background-color: #16213e; border: 1px solid #2a3b5a; max-width: 500px; }
        .form-label { color: #a7c5eb; }
        .form-control, .form-select { background-color: #1f4068; color: #e0e0e0; border-color: #536976; }
        .form-control:focus, .form-select:focus { background-color: #1f4068; color: #e0e0e0; border-color: #e94560; box-shadow: none; }
        .btn-primary { background-color: #e94560; border: none; font-weight: bold; }
        .btn-primary:hover { background-color: #c43751; }
        #suggestions { border: 1px solid #536976; max-height: 150px; overflow-y: auto; background-color: #1f4068; }
        #suggestions div { padding: 8px 12px; cursor: pointer; }
        #suggestions div:hover { background-color: #536976; }
        .form-check-input:checked { background-color: #e94560; border-color: #e94560; }
    </style>
</head>
<body>
    <div class="container-fluid">
        <div class="col-lg-5 col-md-7">
            <div class="card p-4 shadow">
                <div class="card-body">
                    <h1 class="card-title text-center mb-4" style="color: #e94560;">ðŸ“ˆ AI Backtester</h1>
                    <form action="/backtest" method="post">
                        
                        <div class="mb-3">
                            <label for="stock_name" class="form-label">Stock Symbol</label>
                            <input type="text" class="form-control" id="stock_name" name="stock_name" placeholder="Search Stock (à¤‰à¤¦à¤¾. RELIANCE)" required autocomplete="off">
                            <div id="suggestions" class="mt-1"></div>
                        </div>

                        <div class="mb-3">
                            <label for="strategy" class="form-label">Select Strategy</label>
                            <select class="form-select" id="strategy" name="strategy" required>
                                <option value="ema_cross">EMA Crossover (9/20)</option>
                                <option value="rsi_strategy">RSI Strategy</option>
                                <option value="golden_cross">Golden Cross (50/200 SMA)</option>
                            </select>
                        </div>

                        <div class="mb-3">
                            <label for="timeframe" class="form-label">Select Timeframe</label>
                            <select class="form-select" id="timeframe" name="timeframe" required>
                                <option value="1d">Daily</option>
                                <option value="1wk">Weekly</option>
                                <option value="1mo">Monthly</option>
                                <option value="1h">1 Hour</option>
                                <option value="30m">30 Minutes</option>
                                <option value="15m">15 Minutes</option>
                                <option value="5m">5 Minutes</option>
                            </select>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">Indicators to Plot</label>
                            <div class="d-flex justify-content-around">
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="checkbox" name="indicators" value="ema" id="ema_check">
                                    <label class="form-check-label" for="ema_check">EMA</label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="checkbox" name="indicators" value="bbands" id="bb_check">
                                    <label class="form-check-label" for="bb_check">Bollinger Bands</label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="checkbox" name="indicators" value="supertrend" id="st_check">
                                    <label class="form-check-label" for="st_check">SuperTrend</label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="checkbox" name="indicators" value="rsi" id="rsi_check">
                                    <label class="form-check-label" for="rsi_check">RSI</label>
                                </div>
                            </div>
                        </div>

                        <div class="d-grid">
                            <button type="submit" class="btn btn-primary btn-lg mt-3">Run Backtest</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        const stockInput = document.getElementById('stock_name');
        const suggestionsDiv = document.getElementById('suggestions');

        stockInput.addEventListener('input', async function() {
            const query = this.value;
            if (query.length < 1) {
                suggestionsDiv.innerHTML = '';
                return;
            }
            const response = await fetch(`/search?q=${query}`);
            const stocks = await response.json();
            
            suggestionsDiv.innerHTML = '';
            stocks.forEach(stock => {
                const div = document.createElement('div');
                div.textContent = `${stock.SYMBOL} - ${stock['NAME OF COMPANY']}`;
                div.addEventListener('click', function() {
                    stockInput.value = stock.SYMBOL;
                    suggestionsDiv.innerHTML = '';
                });
                suggestionsDiv.appendChild(div);
            });
        });
    </script>
</body>
</html>